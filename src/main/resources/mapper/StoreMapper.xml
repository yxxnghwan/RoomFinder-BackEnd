<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTDMapper3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
	<mapper namespace="com.roomfinder.mapper.StoreMapper">
		<insert id="insertStoreImage" parameterType="com.roomfinder.vo.StoreImageVO">
			INSERT INTO STORE_IMAGE(store_image_res, store_email)
			values(#{store_image_res}, #{store_email})
		</insert>
		
		<select id="getStoreList" resultType="com.roomfinder.vo.StoreVO">
			SELECT * FROM STORE
		</select>
		
		<select id="getStoreImage" parameterType="int" resultType="com.roomfinder.vo.StoreImageVO">
			SELECT * FROM STORE_IMAGE
			WHERE store_image_seq = #{store_image_seq}
		</select>
		
		<select id="getLocationSearchStoreList" parameterType="String" resultType="com.roomfinder.vo.StoreVO">
			SELECT * FROM STORE
			WHERE address_line like '%${search_keyword}%'
		</select>
		
		<select id="getPriceSearchStoreList" parameterType="com.roomfinder.vo.SearchVO" resultType="com.roomfinder.vo.StoreVO">
			SELECT STORE.* FROM STORE, ROOM
			WHERE STORE.email = ROOM.store_email
			AND ROOM.price_per_hour BETWEEN #{min_price} AND #{max_price}
		</select>
		
		<select id="getStoreNameSearchStoreList" parameterType="String" resultType="com.roomfinder.vo.StoreVO">
			SELECT * FROM STORE
			WHERE store_name like '%${search_keyword}%'
		</select>
		
		<select id="getTotalSearchStoreList" parameterType="String" resultType="com.roomfinder.vo.StoreVO">
			SELECT * FROM STORE
			WHERE store_name like '%${search_keyword}%'
			OR address_line like '%${search_keyword}%'
		</select>
		
		<select id="getStoreImageList" parameterType="String" resultType="com.roomfinder.vo.StoreImageVO">
			SELECT * FROM STORE_IMAGE
			WHERE store_email = #{store_email}
		</select>
		
		<update id="updateStoreRepresentingImage" parameterType="com.roomfinder.vo.StoreVO">
			UPDATE STORE
			SET store_representing_image_res = #{store_representing_image_res}
			WHERE email = #{email}
		</update>
		
		<update id="updateStore" parameterType="com.roomfinder.vo.StoreVO">
			UPDATE STORE
			SET store_name = #{store_name},
			address_line = #{address_line},
			telephone = #{telephone},
			operating_time = #{operating_time},
			description = #{description},
			store_representing_image_res = #{store_representing_image_res}
			WHERE email = #{email}
		</update>
		
		<update id="updateStoreImageRes" parameterType="com.roomfinder.vo.StoreImageVO">
			UPDATE STORE_IMAGE
			SET store_image_res = #{store_image_res}
			WHERE store_iamge_seq = #{store_iamge_seq}
		</update>
		
		<delete id="deleteStoreImage" parameterType="com.roomfinder.vo.StoreImageVO">
			DELETE FROM STORE_IMAGE
			WHERE store_image_seq = #{store_image_seq}
		</delete>
	</mapper>